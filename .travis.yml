sudo: required

services:
 - docker

language: bash

jobs:
  include:
  - stage: Build iobroker
    script: ./build/travis_build.sh
    env:
    - DOCKER_ARCH=amd64
  - script: ./build/travis_build.sh
    env:
    - DOCKER_ARCH=arm64
  - script: ./build/travis_build.sh
    env:
    - DOCKER_ARCH=arm

  - stage: Build iobroker full
    script: ./build/travis_build.sh
    env:
    - DOCKER_ARCH=amd64
    - TAG_PREFIX=full-
    - CONFIG_FILE="./build.all.config"
  - script: ./build/travis_build.sh
    env:
    - DOCKER_ARCH=arm64
    - TAG_PREFIX=full-
    - CONFIG_FILE="./build.all.config"
  - script: ./build/travis_build.sh
    env:
    - DOCKER_ARCH=arm
    - TAG_PREFIX=full-
    - CONFIG_FILE="./build.all.config"

  - stage: Manifest iobroker
    script: ./build/travis_manifest.sh

  - stage: Manifest iobroker-full
    script: ./build/travis_manifest.sh
    env:
      - TAG_PREFIX=full-
      - CONFIG_FILE="./build.all.config"
